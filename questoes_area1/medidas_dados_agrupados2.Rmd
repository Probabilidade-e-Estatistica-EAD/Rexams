```{r data_generation, echo = FALSE, results = "hide"}
# Dados da questao
ponto.medio <- c(1, 3, 5, 7, 9)
x <- sample(x = ponto.medio, size = 50, replace = TRUE)
freq <- c(table(x))

cjFj <- ponto.medio*freq

cj2Fj <- ponto.medio^2*freq


# solução
media <- round(sum(ponto.medio*freq)/50, 1)
desvio <- round( sqrt( sum( (ponto.medio - media)^2 * freq ) / 49 ), 1)
  
## single-choice incl. typical errors
sc <- num_to_schoice(correct = media,
                     wrong = round(min(1.5 * media, 9), 1),
                     range = c(max(0, media - 2),
                               min(10, media + 2)),
                     delta = 0.2,
                     method = "delta",
                     digits = 1)

# guardando deltas gerados para respostas erradas
deltas <- as.numeric(gsub("\\$", "", sc$questions)) - media

# padronizacao das respostas da media
sc$questions <- gsub("\\$", "", sc$questions)
sc$questions <- gsub("\\.", ",", sc$questions)

# alterando uma media aleatoriamente para repetir correta
item_errado <- sample(which(sc$solutions == F), 1) 
sc$questions[item_errado] <- sc$questions[ sc$solutions == T ]
  
# incluindo desvios (??podemos ter desvios negativos??)
desvio_deltas <- gsub("\\.", ",", format(round(desvio + deltas, 1), nsmall=1))
sc$questions <- paste(sc$questions, "; ", desvio_deltas, sep="")
sc
```

Question
========
A tabela abaixo apresenta a distribuição de frequências das notas obtidas num teste de matemática, realizado por 50 estudantes.

| Notas            | Frequência |
| :----------------------------- | :-----------------: |
| 0 $\vdash$ 2      |        `r freq[1]`        |
| 2 $\vdash$ 4        |      `r freq[2]`      |
| 4 $\vdash$ 6       |      `r freq[3]`   |
| 6 $\vdash$ 8     |         `r freq[4]`  |
| 8 $\vdash\dashv$ 10 |       `r freq[5]`      |

A média e o desvio padrão das notas desses estudantes são respectivamente

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(sc$questions, markup = "markdown")
```

Solution
========
A média aritmética para dados agrupados por intervalo de classe é dada por $\bar{x} = \frac{\sum_{j}{c_jF_j}}{n}$ em que, $c_j$ é o ponto médio do intervalo de classe, e $F_j$ é a frequência absoluta da classe $j$. Assim, temos

| Notas                               |  Frequência   |           $c_jF_j$           |
| :---------------------------------- | :-----------: | :--------------------------: |
| 0 $\vdash$ 2                        |  `r freq[1]`  |         `r cjFj[1]`          |
| 2 $\vdash$ 4                        |  `r freq[2]`  |         `r cjFj[2]`          |
| 4 $\vdash$ 6                        |  `r freq[3]`  |         `r cjFj[3]`          |
| 6 $\vdash$ 8                        |  `r freq[4]`  |         `r cjFj[4]`          |
| 8 $\vdash\dashv$ 10                 |  `r freq[5]`  |         `r cjFj[5]`          |
| ----------------------------------- | ------------- | ---------------------------- |
| $\sum_{j}{c_jF_j}$                  |               |        `r sum(cjFj)`         |
| $\bar{x} = (\sum_{j}{c_jF_j})/n$   |               |  `r round(sum(cjFj)/50, 1)`  |



E o desvio padrão é dado pela raiz quadrada da variância:


| Notas                               |  Frequência   |           $c_j^2F_j$           |
| :---------------------------------- | :-----------: | :--------------------------: |
| 0 $\vdash$ 2                        |  `r freq[1]`  |         `r cj2Fj[1]`          |
| 2 $\vdash$ 4                        |  `r freq[2]`  |         `r cj2Fj[2]`          |
| 4 $\vdash$ 6                        |  `r freq[3]`  |         `r cj2Fj[3]`          |
| 6 $\vdash$ 8                        |  `r freq[4]`  |         `r cj2Fj[4]`          |
| 8 $\vdash\dashv$ 10                 |  `r freq[5]`  |         `r cj2Fj[5]`          |
| ----------------------------------- | ------------- | ---------------------------- |
| $\sum_{j}{c_j^2F_j}$                  |               |        `r sum(cj2Fj)`         |
| $s^2 = (\sum_{j}{c_j^2F_j}-n \cdot \bar{x}^2)/(n-1)$ |              |  `r desvio^2`  |

Assim, $s = \sqrt{`r desvio^2`} = `r desvio`$


```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(sc$solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(sc$solutions, single = TRUE)`
exname: medidas resumo dados grupados