```{r data_generation, echo = FALSE, results = "hide"}
# dados aleatorios da questao
# questions <- rep(0, 5)
# ## gerar ate que todas alternativas sejam diferentes
# while( (length(unique(questions)) < 5)  & any(diff(questions[order(questions)] ) < 0.02)){
#   vacinas <- imunizs <- 0
#   while(any(vacinas == 0)) vacinas <- c(rmultinom(1, 10, c(0.7, 0.4))) / 10  # prob marginal
#   while(any(imunizs == 0) & length(unique(imunizs))!=2) 
#         imunizs <- c(rbinom(2, 20, 0.75)) / 20     # probs condicionais
#   conj <- vacinas * imunizs # probs conjuntas
#   total <- sum(conj)        # prob total
#   bayes <- conj / total
#   
#   ## se aleatorizar professor para pergunta
#   # vacinas <- c("A", "B")  # identificacao dos professores
#   # por enquanto selecionamos o prof C
#   # profsol <- sample(1:3, 1) # professor selecionado para pergunta
#   
#   ## respostas
#   # sol <- conj[profsol] / total
#   sol <- conj[1] / total
#   err <- c(total, conj[2], conj[1], vacinas[1])
#   
#   ## Faca a resposta correta ser a primeira e as outras falsas
#   questions <- c(sol, err)
# }

## Faca a resposta correta ser a primeira e as outras falsas
# questions <- format(round(c(sol, err), 2), nsmall = 2)   # respostas com aleatorizacao
questions <- c("21/37.", "0,5.", "0,42.", "0,68.", "42/75.")   # respostas originais sem aleatorizacao
solutions <- c(TRUE, rep(FALSE, 4))

# aleatorizando o vetor de alternativas
o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]
```

Question
========

Dois novos tipos de vacina contra determinada doença estão sendo testados: a vacina do tipo $A$ e a vacina do tipo $B$. Esses dois tipos de vacinas foram aplicados em uma população de voluntários. Sabe-se que $60 \%$ dos voluntários receberam vacina do tipo $A$ e $40 \%$ dos voluntários restantes receberam vacina do tipo $B$. Sabe-se, também, que a vacina do tipo $A$ fornece $70 \%$ de imunização e a do tipo $B$ fornece $80 \%$ de imunização. Assim, a probabilidade de uma pessoa, escolhida ao acaso, ter recebido a vacina do tipo $A$ dado que está imunizada é igual a

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========
Considere:

Probabilidade de receber a vacina A = $P(A) = 0,6$

Probabilidade de receber a vacina B = $P(B) = 0,4$

Probabilidade de estar imune se recebeu vacina A = $P(I|A) = 0,7$

Probabilidade de estar imune se recebeu vacina B = $P(I|B) = 0,8$

O que queremos é:

$P(A|I) = \frac{P(A \cap I)}{P(I)} =  \frac{P(A)*P(I|A)} {P(A)*P(I|A)+P(B)*P(I|B)}$


$P(A|I)  = \frac{(0,6*0,7)}{(0,6*0,7)+(0,4*0,8)} = \frac{0,42}{0,74} = \frac{21}{37}$



```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: conceitos basicos