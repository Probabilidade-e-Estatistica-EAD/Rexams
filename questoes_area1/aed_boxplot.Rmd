```{r data_generation, echo = FALSE, results = "hide"}
# Dados da questao

source("C:/Users/Rodrigo/Documents/UFRGS/Disciplinas/2019-01/EAD/prova/arquivosR/printList.R")

min.peso <- sample(x = 78:83, size = 1)
max.peso <- sample(x = 95:100, size = 1)

peso.antes <- c(min.peso, min.peso + 7, min.peso + 9, max.peso - 5, max.peso)

min.peso <- sample(x = 77:78, size = 1)
max.peso <- sample(x = 88:89, size = 1)

peso.depois <- c(min.peso, min.peso + 3, min.peso + 4, max.peso - 3, max.peso)

# df.peso <- data.frame(peso = c(peso.antes, peso.depois),
#                       tempo = c(rep(1, 5),rep(2, 5)))
# 
# fivenum.antes <- fivenum(df.peso$peso[df.peso$tempo == 1])
# fivenum.depois <- fivenum(df.peso$peso[df.peso$tempo == 2])

# Faca a resposta correta ser a primeira e as outras falsas


alternativas <- c(
  paste("Antes do tratamento, o peso mediano dos pacientes era superior a ", round(mean(peso.antes[2:3]))," kg.", sep = ""), 
  paste("Antes do tratamento, 25% dos pacientes pesavam ", peso.antes[4], " kg ou mais.", sep = ""),
  paste("Após o tratamento, 75% dos pacientes passaram a pesar menos de ", peso.depois[2], " kg.", sep = ""),
  paste("Após o tratamento, 25% dos pacientes passaram a pesar de ", peso.depois[2], " kg a ", peso.depois[4], " kg.", sep = ""))

verdade <- c(TRUE, TRUE, FALSE, FALSE)

o <- sample(1:4)
alternativas <- alternativas[o]
verdade <- verdade[o]

romanos <- c("I", "II", "III", "IV")

alternativas <- paste(romanos, alternativas, sep = " - ")

questions <- c(paste(romanos[verdade], collapse = " e "),
               romanos[!verdade][1],
               paste(as.character(sort(as.roman(c(romanos[verdade][2], romanos[!verdade][2])))), collapse = " e "),
               paste(paste(as.character(sort(as.roman(c(romanos[verdade], romanos[!verdade][2]))))[1:2], collapse = ", "), as.character(sort(as.roman(c(romanos[verdade], romanos[!verdade][2]))))[3], sep = " e "),
               paste(paste(as.character(sort(as.roman(c(romanos[verdade][1], romanos[!verdade]))))[1:2], collapse = ", "), as.character(sort(as.roman(c(romanos[verdade][1], romanos[!verdade]))))[3], sep = " e ")
               )

solutions <- c(TRUE, rep(FALSE, 4))

o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]

```

Question
========
Observe o diagrama de caixa (box-plot) do peso de 50 pacientes antes e após a realização de um tratamento.
\
```{r boxplot, echo = FALSE, results = "hide", fig.height = 4, fig.width = 4, fig.path = "", fig.cap = ""}
 par(mar = c(2.5, 4, 1, 0.5))
bp.stats <- boxplot(
  c(rep(peso.antes, 10), rep(peso.depois, 10)) ~ c(
    rep(rep("Antes do tratamento", 5), 10),
    rep(rep("Depois do tratamento", 5), 10)),
  ylab = "Peso (kg)", axes = F, yaxt = "n", range = 2.5)

axis(1, at = 1:2, labels = c("Antes do tratamento", "Depois do tratamento"), cex.axis = 0.7)
axis(2, at = min(bp.stats$stats):max(bp.stats$stats), las = 2, cex.axis = 0.7)
abline(h = min(bp.stats$stats):max(bp.stats$stats), col = "gray50", lty = 3)
boxplot(
  c(peso.antes, peso.depois) ~ c(
    rep("Antes do tratamento", 5),
    rep("Depois do tratamento", 5)),
   axes = F, add = TRUE, col = "white", range = 2.5)
# axis(2, at = c(0, max(y2), max(y1)), labels = c("","",""))
```

Com base nas informações do gráfico, analise as afirmativas abaixo.

I. Antes do tratamento, o peso mediano dos pacientes era superior a `r peso.antes[3]` kg.    
II. Antes do tratamento, 25% dos pacientes pesavam `r peso.antes[4]` kg ou mais.     
III. Após o tratamento, 75% dos pacientes passaram a pesar menos de `r peso.depois[2]` kg.    
IV. Após o tratamento, 25% dos pacientes passaram a pesar de `r peso.depois[2]` kg a `r peso.depois[4]` kg.   

Está(ão) correta(s) apenas a(s) afirmativa(s)

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========

Os quartis $Q_1$, $Q_2$ e $Q_3$ são os valores que dividem um conjunto de dados ordenados em quatro partes iguais. O gráfico de boxplot é construído a partir dos quartis da distribuição de um certo conjunto de dados. Os limites inferior e superior da "caixa" do gráfico são especificados pelo 1º e 3º quartis da distribuição, respectivamente. A linha do interior da "caixa" é especificada pelo valor da mediana (2º quartil) da distribuição. As cerquilhas são formadas, em geral, pela regra

\begin{eqnarray*}
Q_1 - (Q_3 - Q_1) \times 1,5,\quad \mbox{cerquilha inferior},\\
Q_3 + (Q_3 - Q_1) \times 1,5,\quad \mbox{cerquilha superior}.
\end{eqnarray*}

```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: boxplot e quartis