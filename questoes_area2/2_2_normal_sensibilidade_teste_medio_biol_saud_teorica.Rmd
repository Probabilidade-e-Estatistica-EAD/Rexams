```{r, include = FALSE, message = FALSE, warning = FALSE}
library(exams)
```


```{r data_generation, echo = FALSE, results = "hide"}
questions <- paste(c("97,5%","1,5%","5%","87%","99%"))
solutions <- c(TRUE, rep(FALSE, 4))

o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]

```

Question
========

A reação da tuberculina detecta se um indivíduo está infectado ou não pelo bacilo de Koch. Injetando-se na derme uma solução de tuberculina e medindo-se 48h após a injeção o diâmetro da zona endurecida, a reação será classificada em (+) ou (-). Suponha que os resultados de uma investigação sobre essa reação, entre uma amostra de infectados e não infectados, sejam os seguintes, em relação ao diâmetro da zona endurecida:

|Indivíduos|Média (mm)|Desvio Padrão (mm)|
|:----------|:-----:|:-----:|
|Não infectados|3,5|1,0|
|Infectados|8,0|1,5|

Suponha que se estabeleça a norma de chamar positiva a reação que tenha 5 mm de diâmetro ou mais, e negativa a reação de menos de 5 mm. Na distribuição normal, sabe-se que a percentagem de área, conforme determinados intervalos característicos, é, aproximadamente, a seguinte, onde $\mu$ é a média e $\sigma$ é o desvio padrão:

|Intervalo|% dentro do intervalo|
|:-------------------:|:-------:|
|$[\mu - \sigma ; \mu + \sigma]$|69%|
|$[\mu - 1,5\sigma ; \mu + 1,5\sigma]$|87%|
|$[\mu - 2\sigma ; \mu + 2\sigma]$|95%|
|$[\mu - 3\sigma ; \mu + 3\sigma]$|99%|

Qual a sensibilidade do teste, isto é, de se classificar como positivo um indivíduo que realmente esteja infectado?

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========

Para calcular a probabilidade de se classificar como positivo um indivíduo que realmente esteja infectado, vamos primeiro definir o que é "ser classificado como positivo".

De acordo com o enunciado, se o diâmetro da zona endurecida for maior ou igual a 5 mm, então o indivíduo é classificado como positivo.

Vamos considerar uma variável aleatória contínua X como o diâmetro da zona endurecida de um indivíduo que participou desse experimento.

Utilizando os dados da primeira tabela, se um indivíduo está infectado, então $X \sim N(\mu = 8,0, \sigma^2 = 1,5^2)$.

Utilizando os dados da segunda tabela, podemos criar outra a partir do conhecimento de que o indivíduo foi classificado positivamente

|Intervalo|% dentro do intervalo|
|:-------------------:|:-------:|
|$[8-1,5 ; 8+1,5]$|69%|
|$[8-2,25 ; 8+2,25]$|87%|
|$[8-3 ; 8+3]$|95%|
|$[8-4,5 ; 8+4,5]$|99%|

|Intervalo|% dentro do intervalo|
|:-------------------:|:-------:|
|$[6,5;9,5]$|69%|
|$[5,75;10,25]$|87%|
|$[5;11]$|95%|
|$[3,5;12,5]$|99%|

Note que a terceira linha nos diz que entre 5 mm e 11 mm há 95% de probabilidade. Como a distribuição normal é simétrica, temos 2,5% de probabilidade de ser menor que 5 mm e 2,5% de probabilidade de ser maior que 11 mm.

Com essa informação, já podemos calcular a probabilidade de um indivíduo ser classificado como positivo, dado que ele é realmente positivo, como a área maior do que 5, que é igual a 97,5%.


```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: normal sensibilidade teste