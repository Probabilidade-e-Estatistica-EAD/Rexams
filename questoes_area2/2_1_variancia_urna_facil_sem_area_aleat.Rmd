```{r, include = FALSE, message = FALSE}
library(exams)
```

```{r data_generation, echo = FALSE, results = "hide"}
#Dados da questao
n_bolas <- sample(1:10, 5)
p <- 1/5

esp <- n_bolas[1]*p + n_bolas[2]*p + n_bolas[3]*p + n_bolas[4]*p + n_bolas[5]*p

esp_2 <- (n_bolas[1]^2)*p + (n_bolas[2]^2)*p + (n_bolas[3]^2)*p + (n_bolas[4]^2)*p + (n_bolas[5]^2)*p

var <- round(esp_2 - esp^2, digits = 2) #var

#Erros:
err1 <- round(esp_2 + esp^2, digits = 2)
err2 <- round(esp_2 - esp, digits = 2)

rand1 <- ceiling(var) - round(runif(1, min = 2, max = 5), digits = 2)
rand2 <- ceiling(var) + round(runif(1, min = 6, max = 9), digits = 2)

#Faca a resposta correta ser a primeira e as outras falsas
questions <- c(var, err1, err2, rand1, rand2)
solutions <- c(TRUE, rep(FALSE, 4))

o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]

```

Question
========
Uma urna contém 5 bolas de dimensões idênticas numeradas `r n_bolas`. Uma bola é sorteada ao acaso da urna. Seja $X$ o número da bola escolhida. A variância de $X$ é igual a:

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========
$V(X) = E(X^2) - E(X)^2\\$

$E(X) = `r n_bolas[1]` \cdot \left (\frac{1}{5}\right) + `r n_bolas[2]` \cdot \left (\frac{1}{5}\right) + `r n_bolas[3]` \cdot \left (\frac{1}{5}\right) + `r n_bolas[4]` \cdot \left (\frac{1}{5}\right) + `r n_bolas[5]` \cdot \left (\frac{1}{5}\right)\\$

$E(X) = `r esp`\\$

$E(X^2) = `r n_bolas[1]`^2 \cdot \left (\frac{1}{5}\right) + `r n_bolas[2]`^2 \cdot \left (\frac{1}{5}\right) + `r n_bolas[3]`^2 \cdot \left (\frac{1}{5}\right) + `r n_bolas[4]`^2 \cdot \left (\frac{1}{5}\right) + `r n_bolas[5]`^2 \cdot \left (\frac{1}{5}\right)\\$

$E(X^2) = `r esp_2`$

$V(X) = E(X^2) - E(X)^2 = `r var`$


```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: variaveis aleatorias discretas