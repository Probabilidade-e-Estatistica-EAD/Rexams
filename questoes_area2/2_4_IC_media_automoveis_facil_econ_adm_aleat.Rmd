```{r, include = FALSE, warning = FALSE, message = FALSE}
library(exams)
```


```{r data_generation, echo = FALSE, results = "hide"}
#Dados da questao
n <- sample(9:25, size = 1)

alfa <- (1-0.95)/2
t_tab = round(abs(qt(alfa, n-1)), 3)

xbarra <- sample(1045:1065, size = 1)
dp <- sample(145:165, size = 1)

e <- round(t_tab * (dp/sqrt(n)), 2) 
IC_min <- round(xbarra - e, 2)
IC_max <- round(xbarra + e, 2)
IC <- c(IC_min, IC_max)

#Respostas:
rand_min <- IC_min - round(runif(4, 4, 25),2)
rand_max <- IC_max + round(runif(4, 4, 25),2)

corret <- paste0("[R$", format(IC_min, nsmall = 2),"; R$", format(IC_max, nsmall = 2), "]")
err <- paste0("[R$", format(rand_min, nsmall = 2),"; R$",format(rand_max, nsmall = 2),"]")

#Faca a resposta correta ser a primeira e as outras falsas
questions <- c(corret, err[1], err[2], err[3], err[4])
solutions <- c(TRUE, rep(FALSE, 4))

o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]
```

Question
========
Uma revenda de automóveis vende carros montados no Brasil. O proprietário está interessado em estimar o valor médio $\mu$ dos gastos extras com opcionais casados com a compra de carros novos. Uma amostra de `r n` vendas produziu um valor médio de $R\$`r xbarra`$ com desvio padrão de $R\$ `r dp`$. Assinale a opção que dá os limites de confiança para $\mu$ com coeficiente de 95%, considerando $t_{tab} = `r t_tab`$.


```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========
n = `r n`, G.L. = `r n-1`, $\bar X = `r xbarra`$, $s = `r dp`$ e $\alpha = 0.05\\$

$\epsilon = t_{tab} \cdot \frac{S}{\sqrt{n}}\\$

$\epsilon = `r t_tab` \cdot \frac{`r dp`}{\sqrt{`r n`}}\\$

$\epsilon = `r e`\\$

$I.C. = [\bar X - \epsilon;\bar X + \epsilon]\\$

$I.C. = [`r xbarra` - `r e`; `r xbarra` + `r e`]\\$

$I.C. = [`r IC_min`; `r IC_max`]$


```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```


Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: intervalo de confianca media
