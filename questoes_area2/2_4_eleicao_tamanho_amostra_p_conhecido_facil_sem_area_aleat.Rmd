```{r, include = FALSE, message = FALSE, warning = FALSE}
library(exams)
```


```{r data_generation, echo = FALSE, results = "hide"}
# Dados da questão 
p <- round(runif(1, 0.4, 0.7),2)
result <-  round(((1.96)^2)*(p*(1-p)),3) /  0.02^2


questions <- c(paste(ceiling(result), ' pessoas'),
               paste(ceiling(round(((1.96)^2)*(p*(1-p)),3) /  0.02), ' pessoas'),
               paste(ceiling(round((p*(1-p)),3) /  0.02^2), ' pessoas'),
               paste(ceiling(round((1.96)*(p*(1-p)),3) /  0.02^2), ' pessoas'),
               paste(ceiling(result) - ceiling(runif(1,100,1000)), ' pessoas'))

solutions <- c(TRUE, rep(FALSE, 4))

o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]

```

Question
========

Uma pesquisa recente foi realizada para avaliar o percentual da população favorável à eleição de um determinado ponto turístico para constar no selo comemorativo de aniversário da cidade. Para isso, selecionou-se uma amostra piloto e o resultado apurou `r paste0(p*100, '%')` de intenção de votos para esse ponto turístico. Considerando que a margem de erro foi de 2 pontos percentuais, para mais ou para menos, e que o nível de confiança utilizado foi de 95%, foram ouvidas, aproximadamente:

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========

O exercício nos forneceu as seguintes informações: Nível de confiança = 0.95, erro = 0.02, proporção = 0.5. O objetivo da questão é usar essas informações para calcular o tamanho de amostra. Este é o caso em que a proporção é conhecida, por isso usaremos a fórmula

$n = \displaystyle{\frac{Z^2_{\alpha/2} `r p`(`r 1-p`)}{e^2}}$

$n = \displaystyle{\frac{(1.96)^2 `r p`(1-`r p`)}{(0.02)^2}}$

$n = \displaystyle{\frac{`r round(((1.96)^2)*(p*(1-p)),3)`}{`r 0.02^2`}}$

$n = `r result`$

Arredondando para o número mais próximo, temos $n = `r ceiling(result)`$.

```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: tamanho de amostra p conhecido