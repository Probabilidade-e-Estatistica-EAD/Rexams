```{r, include = FALSE, message = FALSE, warning = FALSE}
library(exams)
```


```{r data_generation, echo = FALSE, results = "hide"}
media <- sample(160:175, size = 1)
dp <- sample(5:12, size = 1)
porc <- round(runif(1, 0.05, 0.10), 2)
prob <- 1 - porc
z <- round(qnorm(prob, 0, 1), 2)

x <- round(z*dp + media, 2)
correta <- paste0(round(x, 0), " cm")

erro1 <- round(x, 0) - sample(3:6, size = 2, replace = FALSE)
erro2 <- round(x, 0) + sample(7:9, size = 2, replace = FALSE)

erros1 <- paste0(erro1, " cm")
erros2 <- paste0(erro2, " cm")

questions <- c(correta, erros1[1], erros1[2], erros2[1], erros2[2])
solutions <- c(TRUE, rep(FALSE, 4))

o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]

```

Question
========

Seja X a altura das pessoas de uma determinada população. Suponha que ela siga o modelo normal com média `r media` cm e desvio padrão `r dp` cm. Supondo que `r porc*100`% das pessoas mais altas possam ser convidados para a prática de basquete. Então a altura mínima para receber tal convite, considerando o resultado arredondado para o cm mais próximo, seria:

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========

Sabemos que $X \sim N(\mu = `r media`,\sigma^2 = `r dp`^2)$. Para descobrir a altura mínima para receber o convite, precisamos descobrir o ponto de X no qual, depois dele, acumule `r porc*100`% de probabilidade. Ou ainda, um ponto $x$ no qual $P(X > x) = `r porc`$.

Quando estamos calculando probabilidades de uma variável aleatória normal, é muito útil utilizarmos a distribuição normal padrão, transformando a variável aleatória X em uma nova variável aleatória Z de forma que $Z = \displaystyle\frac{X - \mu}{\sigma} = \frac{X - `r media`}{`r dp`}$. Assim, vamos buscar um valor de X para o qual

$P(Z > \displaystyle\frac{X - `r media`}{`r dp`}) = `r porc`$ ou ainda

$P(Z < \displaystyle\frac{X - `r media`}{`r dp`}) = `r prob`$

Ao olharmos na tabela da distribuição normal padrão, precisamos encontrar o valor de Z que acumule `r prob*100`% de probabilidade, pois acima desse ponto é acumulado `r porc*100`% de probabilidade. Tal ponto é `r z`. Substituindo $Z = `r z`$ na equação acima, temos

$`r z` = \displaystyle\frac{X-`r media`}{`r dp`}$

$`r z*dp` = X - `r media`$

$X = `r x`$

Portanto, $P(X \ge `r x`) = `r porc`$

Ou seja, `r round(x, 0)` cm (arredondando para o número mais próximo) é a altura mínima para receber o convite.

```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: normal basquete