```{r, include = FALSE, message = FALSE}
library(exams)
```

```{r data_generation, echo = FALSE, results = "hide"}
#Dados da questao
n <- sample(10:25, size = 1)
xbarra <- round(runif(1, min = 2.5, max = 4.0), digits = 2)
s <- round(runif(1, min = 0.5, max = 1.2), digits = 2)

alfa <- (1-0.95)/2
t_tab = round(abs(qt(alfa, n-1)), 3)

e <- round(t_tab * (s/sqrt(n)), 3)
ic_min <- xbarra - e
ic_max <- xbarra + e

#Respostas:
rand_min <- ic_min - round(runif(4,0.1,0.5),2)
rand_max <- ic_max + round(runif(4,0.1,0.5),2)

corret <- paste("[",ic_min,";",ic_max,"]")
err <- paste("[",rand_min,";",rand_max,"]")

#Faca a resposta correta ser a primeira e as outras falsas
questions <- c(corret, err[1], err[2], err[3], err[4])
solutions <- c(TRUE, rep(FALSE, 4))

o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]
```

Question
========
O peso de crianças recém-nascidas do sexo feminino numa comunidade tem distribuição normal com média P e desvio padrão desconhecido. Uma amostra de `r n` recém-nascidas indicou um peso médio de `r xbarra` kg e desvio padrão amostral igual a `r s` kg. Um intervalo de confiança para P, com coeficiente de confiança de 95%, com $t_{tab} = `r t_tab`$:


```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========
n = `r n`, G.L. = `r n-1`, $\mu = `r xbarra`kg$, $\sigma = `r s`kg$ e $\alpha = 0.05\\$

$\epsilon = t_{tab} \cdot \frac{S}{\sqrt{n}}\\$

$\epsilon = {`r t_tab`} \cdot \frac{`r s`}{\sqrt{`r n`}}\\$

$\epsilon = `r e`\\$

$I.C. = [\bar X - \epsilon;\bar X + \epsilon]\\$

$I.C. = [`r xbarra` - `r e`; `r xbarra` + `r e`]\\$

$I.C. = [`r ic_min`; `r ic_max`] \\$

```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: intervalo de confianca media
