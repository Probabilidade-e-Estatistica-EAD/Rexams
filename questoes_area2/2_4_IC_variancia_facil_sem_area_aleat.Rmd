```{r, include = FALSE, message = FALSE, warning = FALSE}
library(exams)
```


```{r data_generation, echo = FALSE, results = "hide"}
#Dados da questão:
n <- sample(10:20, size = 1)
xbarra <- round(runif(1, 4, 8.5), 1)
dp <- round(runif(1, 1.2, 3.5), 1)

ic_min <- round((n*dp)/27.4884, 4)
ic_max <- round((n*dp)/6.2621, 4)

#Respostas:
err_min <- ic_min - runif(4,0.1,1)
err_max <- ic_max + runif(4,0.1,1)

corret <- paste0("[", round(ic_min, 2), "; ", round(ic_max, 2), "]")
erro <- paste0("[", round(err_min, 2), "; ", round(err_max, 2), "]")

questions <- c(corret, erro[1], erro[2], erro[3], erro[4])
solutions <- c(TRUE, rep(FALSE, 4))

o <- sample(1:5)
questions <- questions[o]
solutions <- solutions[o]

```

Question
========

Uma amostra aleatória simples de tamanho `r n` foi selecionada para estimar a média desconhecida de uma população normal. A média amostral encontrada foi `r xbarra` e a variância amostral foi `r dp` O intervalo de 95% de confiança para a variância populacional é:

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(questions, markup = "markdown")
```

Solution
========

O intervalo de confiança para a variância populacional de uma distribuição normal é dado por

$IC(\sigma^2,1-\alpha) = \left[\displaystyle{ \frac{ (n-1)S^2 }{ Q_{ 1-\frac{ \alpha } { 2 } } }};\displaystyle{ \frac{ (n-1)S^2 }{ Q_{ \frac{ \alpha } { 2 } } }}\right]$

Onde $1-\alpha$ é o nível de confiança, $\sigma^2$ é a variância desconhecida, $n$ é o tamanho de amostra, $S^2$ é a variância amostral e $Q_i$ é o valor tabelado da distribuição $\chi^2$ com n-1 graus de liberdade, no qual $Q_{ \frac{ \alpha } { 2 }}$, por exemplo, é o valor que acumula $\displaystyle{\frac{\alpha}{2}}$ de probabilidade.

Usando a tabela da $\chi^2$, podemos constatar que

$Q_{0,975} = 27.4884$ e
$Q_{0,025} = 6.2621$

Assim,

$IC(\sigma^2, 0.95) = \left[\displaystyle\frac{`r n-1` * `r dp`}{27.4884}; \frac{`r n-1`*`r dp`}{6.2621}\right]$

$IC(\sigma^2, 0.95) = [`r ic_min`; `r ic_max`]$ arredondando, temos:

$IC(\sigma^2, 0.95) = [`r round(ic_min, 2)`; `r round(ic_max, 2)`]$ 


```{r solutionlist, echo = FALSE, results = "asis"}
answerlist(ifelse(solutions, "Correta", "Incorreta"), markup = "markdown")
```

Meta-information
================
extype: schoice
exsolution: `r mchoice2string(solutions, single = TRUE)`
exname: IC variancia